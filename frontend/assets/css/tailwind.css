/* import color scheme variables */
@import './scheme.css';

@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    color-scheme: light;
  }
  
  html {
    background-color: rgb(var(--bg));
    color: rgb(var(--fg));
  }
  
  /* 全局字体与等宽数字 */
  body {
    background-color: transparent;
    color: inherit;
    font-family: system-ui, -apple-system, "SF Pro Text", "PingFang SC",
                 "Hiragino Sans GB", "Segoe UI", Roboto, "Noto Sans CJK SC",
                 "Microsoft YaHei UI", Arial, sans-serif;
    -webkit-font-smoothing: antialiased;
    font-feature-settings: "tnum" 1;
    font-variant-numeric: tabular-nums;
  }
  
  /* 深色模式 */
  html.dark {
    color-scheme: dark;
  }
  
  /* 浅色模式显式声明 */
  html.light {
    color-scheme: light;
  }
}

@layer components {
  /* Skip to content link: visible on focus for a11y */
  .skip-link {
    position: absolute;
    top: 0.25rem;
    left: 0.25rem;
    z-index: 1000;
    padding: 0.5rem 0.75rem;
    border-radius: 0.5rem;
    background: rgb(var(--panel));
    color: rgb(var(--fg));
    border: 1px solid rgb(var(--panel-border));
    box-shadow: 0 10px 24px rgba(15,23,42,0.12);
    transform: translateY(-200%);
  }
  .skip-link:focus {
    transform: translateY(0);
    outline: 2px solid rgb(var(--accent));
    outline-offset: 2px;
  }

  /* Safe-area padding helpers (for notched devices) */
  .safe-pt { padding-top: env(safe-area-inset-top); }
  .safe-pb { padding-bottom: env(safe-area-inset-bottom); }
  .safe-pl { padding-left: env(safe-area-inset-left); }
  .safe-pr { padding-right: env(safe-area-inset-right); }
  .safe-px { padding-left: env(safe-area-inset-left); padding-right: env(safe-area-inset-right); }
  .safe-py { padding-top: env(safe-area-inset-top); padding-bottom: env(safe-area-inset-bottom); }

  /* 滚动条样式 */
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }
  
  ::-webkit-scrollbar-track {
    @apply bg-transparent;
  }
  
  ::-webkit-scrollbar-thumb {
    @apply bg-neutral-700 dark:bg-neutral-600 rounded;
  }
  
  ::-webkit-scrollbar-thumb:hover {
    @apply bg-neutral-600 dark:bg-neutral-500;
  }
  
  /* 消除输入框默认样式 */
  input[type="search"]::-webkit-search-decoration,
  input[type="search"]::-webkit-search-cancel-button,
  input[type="search"]::-webkit-search-results-button,
  input[type="search"]::-webkit-search-results-decoration {
    -webkit-appearance: none;
  }
  
  /* 选中文本样式 */
  ::selection,
  ::-moz-selection {
    background-color: rgba(var(--accent), 0.55);
    color: #0b1120; /* ensure strong contrast on highlight */
  }

  html.dark ::selection,
  html.dark ::-moz-selection {
    background-color: rgba(var(--accent-weak), 0.65);
    color: #0b1120;
  }
  
  /* 过渡动画（仅常见交互元素，避免全局性能压力） */
  a, button, input, select, textarea {
    @apply transition-colors duration-200;
  }
  @media (prefers-reduced-motion: reduce) {
    a, button, input, select, textarea, .transition-colors { transition: none !important; }
  }
  
  /* 禁用图片拖拽 */
  img {
    -webkit-user-drag: none;
    user-select: none;
  }

  /* Snippet keyword highlight (PGroonga snippet_html -> <span class="keyword">) */
  html.light .keyword {
    @apply rounded px-0.5;
    background-color: #fde68a !important; /* amber-200 */
    color: #111827 !important;           /* neutral-900 */
  }
  html.dark .keyword {
    background-color: rgba(234, 179, 8, 0.35) !important; /* amber-400 @ ~35% */
    color: #f5f5f5 !important;                             /* neutral-100 */
  }

  /* 分段控件（Segmented Control） */
  .segmented {
    @apply inline-flex flex-nowrap gap-1 p-1 border border-neutral-200 dark:border-neutral-800 rounded-full bg-white/80 dark:bg-neutral-900/60 backdrop-blur overflow-x-auto;
  }
  .segmented > button {
    @apply px-3 py-1 text-xs sm:text-sm font-semibold rounded-full text-neutral-600 dark:text-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-800 focus:outline-none focus:ring-2 focus:ring-[rgb(var(--accent))] transition whitespace-nowrap;
  }
  .segmented > button[aria-pressed="true"] {
    @apply bg-white dark:bg-neutral-900 text-neutral-900 dark:text-neutral-100 shadow;
  }
}
